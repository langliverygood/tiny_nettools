#ifndef _ARP_H_
#define _ARP_H_

#define MAC_LEN              6  /* mac地址长度*/
#define IP_LEN               4  /* ip地址长度*/
#define ETHER_ARP_PACKET_LEN 42 /* arp包长度*/
#define ETHER_HEADER_LEN     14 /* 以太网头部长度*/

#pragma pack(push)
#pragma pack(1) 
struct arp_packet{
	/* 以太网头部 */
	unsigned char eth_dst[MAC_LEN];
	unsigned char eth_src[MAC_LEN];
	unsigned short eth_type;   
	/* arp请求/应答 */
	unsigned short ar_hrd;
	unsigned short ar_pro;
	unsigned char ar_hln;
	unsigned char ar_pln;
	unsigned short ar_op;
	unsigned char ar_sha[MAC_LEN];
	unsigned int ar_sip;
	unsigned char ar_dha[MAC_LEN];
	unsigned int ar_dip;
	unsigned char padding[18]; /* 填充 */
}arp_packet_s;
#pragma pack(pop)

/***************************************************************/
/* 函  数：arp_deceive ******************************************/
/* 说  明：arp欺骗 ***********************************************/
/* 参  数：deveice_name 发送数据包的网卡设备 ************************/
/*        trick_ip 伪装的ip *************************************/
/*        target_ip 目标的ip ************************************/
/*        flag 0 使用伪造mac ************************************/
/*             非0 使用本机mac **********************************/
/* 返回值：无 ***************************************************/
/**************************************************************/
void arp_deceive(char *deveice_name, char *trick_ip, char *target_ip, char flag);

/***************************************************************/
/* 函  数：arp_scan *********************************************/
/* 说  明：获得其他主机的mac ***************************************/
/* 参  数：deveice_name 发送数据包的网卡设备 ************************/
/*        target_ip 目标ip **************************************/
/* 返回值：无 ***************************************************/
/**************************************************************/
void arp_scan(char *deveice_name, char *target_ip);

/***************************************************************/
/* 函  数：set_deceive_interval *********************************/
/* 说  明：修改每次发包的时间间隔 **********************************/
/* 参  数：毫秒 *************************************************/
/* 返回值：无 ***************************************************/
/**************************************************************/
void set_deceive_interval(unsigned int interval_ms);

/***************************************************************/
/* 函  数：set_scan_wait_time ***********************************/
/* 说  明：修改接收请求等待时间 ************************************/
/* 参  数：秒 *************************************************/
/* 返回值：无 ***************************************************/
/**************************************************************/
void set_scan_wait_time(unsigned int wait_time_s);

/***************************************************************/
/* 函  数：arp_reset ********************************************/
/* 说  明：重置一些参数设置 ***************************************/
/* 参  数：无 ***************************************************/
/* 返回值：无 ***************************************************/
/**************************************************************/
void arp_reset();

/***************************************************************/
/* 函  数：arp_usage ********************************************/
/* 说  明：介绍arp使用方法 ****************************************/
/* 参  数：无 ***************************************************/
/* 返回值：无 ***************************************************/
/**************************************************************/
void arp_usage();

#endif
